<?xml version="1.0" encoding="UTF-8"?><bpmn2:definitions xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:ifl="http:///com.sap.ifl.model/Ifl.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Definitions_1" name="Definitions 1" targetNamespace="http://com.sap.it.ifl.tooling/default/flow">
    <bpmn2:collaboration id="Collaboration_1" name="Default Collaboration">
        <bpmn2:extensionElements>
            <ifl:property><key>httpSessionHandling</key><value>onIntegrationFlow</value></ifl:property>
            <ifl:property><key>returnExceptionToSender</key><value>false</value></ifl:property>
            <ifl:property><key>componentVersion</key><value>1.2</value></ifl:property>
            <ifl:property><key>cmdVariantUri</key><value>ctype::IFlowVariant/cname::IFlowConfiguration/version::1.2.4</value></ifl:property>
        </bpmn2:extensionElements>
        <bpmn2:participant id="Participant_Sender" ifl:type="EndpointSender" name="Blackline">
            <bpmn2:extensionElements>
                <ifl:property><key>enableBasicAuthentication</key><value>false</value></ifl:property>
                <ifl:property><key>ifl:type</key><value>EndpointSender</value></ifl:property>
                <ifl:property><key>componentVersion</key><value>1.0</value></ifl:property>
            </bpmn2:extensionElements>
        </bpmn2:participant>
        <bpmn2:participant id="Participant_Receiver" ifl:type="EndpointRecevier" name="S4HANA">
            <bpmn2:extensionElements>
                <ifl:property><key>ifl:type</key><value>EndpointRecevier</value></ifl:property>
                <ifl:property><key>componentVersion</key><value>1.0</value></ifl:property>
            </bpmn2:extensionElements>
        </bpmn2:participant>
        <bpmn2:participant id="Participant_Process_1" ifl:type="IntegrationProcess" name="Integration Process" processRef="Process_1"/>
        
        <bpmn2:messageFlow id="MessageFlow_Sender" name="HTTPS" sourceRef="Participant_Sender" targetRef="StartEvent_2">
            <bpmn2:extensionElements>
                <ifl:property><key>adapterType</key><value>HTTPS</value></ifl:property>
                <ifl:property><key>urlPath</key><value>/blackline/inbound</value></ifl:property>
                <ifl:property><key>senderAuthType</key><value>RoleBased</value></ifl:property>
                <ifl:property><key>userRole</key><value>ESBMessaging.send</value></ifl:property>
            </bpmn2:extensionElements>
        </bpmn2:messageFlow>
        <bpmn2:messageFlow id="MessageFlow_Receiver" name="HTTP" sourceRef="EndEvent_2" targetRef="Participant_Receiver">
            <bpmn2:extensionElements>
                <ifl:property><key>adapterType</key><value>HTTP</value></ifl:property>
                <ifl:property><key>httpAddressWithoutQuery</key><value>http://s4hana-virtual-host:8000/sap/bc/srt/rfc/sap/blackline_service</value></ifl:property>
                <ifl:property><key>proxyType</key><value>On-Premise</value></ifl:property>
                <ifl:property><key>authenticationMethod</key><value>Basic</value></ifl:property>
                <ifl:property><key>alias</key><value>S4_TECHNICAL_USER</value></ifl:property>
            </bpmn2:extensionElements>
        </bpmn2:messageFlow>
    </bpmn2:collaboration>
    <bpmn2:process id="Process_1" name="Integration Process">
        <bpmn2:startEvent id="StartEvent_2" name="Start">
            <bpmn2:outgoing>SequenceFlow_1</bpmn2:outgoing>
            <bpmn2:messageEventDefinition/>
        </bpmn2:startEvent>
        <bpmn2:callActivity id="CallActivity_Mapping" name="Mapping Blackline to S4">
            <bpmn2:incoming>SequenceFlow_1</bpmn2:incoming>
            <bpmn2:outgoing>SequenceFlow_2</bpmn2:outgoing>
        </bpmn2:callActivity>
        <bpmn2:endEvent id="EndEvent_2" name="End">
            <bpmn2:incoming>SequenceFlow_2</bpmn2:incoming>
            <bpmn2:messageEventDefinition/>
        </bpmn2:endEvent>
        
        <!-- EXCEPTION SUBPROCESS WITH LOGGING -->
        <bpmn2:subProcess id="SubProcess_Error" name="Exception Handling" triggeredByEvent="true">
            <bpmn2:startEvent id="StartEvent_Error" name="Error Start">
                <bpmn2:errorEventDefinition/>
            </bpmn2:startEvent>
            <bpmn2:callActivity id="CallActivity_LogScript" name="Log Error (Groovy)">
                <bpmn2:extensionElements>
                    <ifl:property><key>script</key><value>errorHandler.groovy</value></ifl:property>
                    <ifl:property><key>componentVersion</key><value>1.1</value></ifl:property>
                </bpmn2:extensionElements>
            </bpmn2:callActivity>
            <bpmn2:endEvent id="EndEvent_Error" name="Error End"/>
            <bpmn2:sequenceFlow id="Flow_E1" sourceRef="StartEvent_Error" targetRef="CallActivity_LogScript"/>
            <bpmn2:sequenceFlow id="Flow_E2" sourceRef="CallActivity_LogScript" targetRef="EndEvent_Error"/>
        </bpmn2:subProcess>

        <bpmn2:sequenceFlow id="SequenceFlow_1" sourceRef="StartEvent_2" targetRef="CallActivity_Mapping"/>
        <bpmn2:sequenceFlow id="SequenceFlow_2" sourceRef="CallActivity_Mapping" targetRef="EndEvent_2"/>
    </bpmn2:process>
    <bpmndi:BPMNDiagram id="BPMNDiagram_1">
        <bpmndi:BPMNPlane bpmnElement="Collaboration_1" id="BPMNPlane_1"/>
    </bpmndi:BPMNDiagram>
</bpmn2:definitions>
